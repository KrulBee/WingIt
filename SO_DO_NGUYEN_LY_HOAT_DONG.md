# S∆° ƒê·ªì Nguy√™n L√Ω Ho·∫°t ƒê·ªông - H·ªá Th·ªëng WingIt

## üìã T·ªïng Quan H·ªá Th·ªëng

WingIt l√† m·ªôt n·ªÅn t·∫£ng m·∫°ng x√£ h·ªôi hi·ªán ƒë·∫°i v·ªõi ki·∫øn tr√∫c microservices, bao g·ªìm c√°c th√†nh ph·∫ßn ch√≠nh:
- **Frontend**: Next.js/React v·ªõi TypeScript
- **Backend**: Spring Boot (Java)
- **AI Service**: Flask (Python) v·ªõi PhoBERT model
- **Database**: PostgreSQL
- **File Storage**: Cloudinary
- **Deployment**: Render Cloud Platform

---

## üèóÔ∏è S∆° ƒê·ªì Ki·∫øn Tr√∫c T·ªïng Th·ªÉ

```mermaid
graph TB
    subgraph "Client Layer"
        WEB[Web Browser]
        MOBILE[Mobile Browser]
    end
    
    subgraph "Frontend Layer"
        NEXTJS[Next.js Frontend<br/>Port: 3000]
        REDUX[Redux Store]
        NEXTJS --> REDUX
    end
    
    subgraph "Backend Layer"
        SPRING[Spring Boot API<br/>Port: 8080]
        JWT[JWT Authentication]
        WEBSOCKET[WebSocket Server]
        SPRING --> JWT
        SPRING --> WEBSOCKET
    end
    
    subgraph "AI Layer"
        FLASK[Flask AI Service<br/>Port: 5000]
        PHOBERT[PhoBERT Model]
        FLASK --> PHOBERT
    end
    
    subgraph "Data Layer"
        POSTGRES[(PostgreSQL Database)]
        CLOUDINARY[Cloudinary<br/>File Storage]
    end
    
    subgraph "External Services"
        GOOGLE[Google OAuth2]
        EMAIL[Email Service]
    end
    
    WEB --> NEXTJS
    MOBILE --> NEXTJS
    NEXTJS --> SPRING
    SPRING --> POSTGRES
    SPRING --> CLOUDINARY
    SPRING --> FLASK
    SPRING --> GOOGLE
    SPRING --> EMAIL
    
    style WEB fill:#e1f5fe
    style MOBILE fill:#e1f5fe
    style NEXTJS fill:#f3e5f5
    style SPRING fill:#e8f5e8
    style FLASK fill:#fff3e0
    style POSTGRES fill:#fce4ec
    style CLOUDINARY fill:#f1f8e9
```

---

## üîÑ S∆° ƒê·ªì Lu·ªìng D·ªØ Li·ªáu Ch√≠nh

```mermaid
flowchart TD
    START([Ng∆∞·ªùi d√πng truy c·∫≠p]) --> LOGIN{ƒê√£ ƒëƒÉng nh·∫≠p?}
    
    LOGIN -->|Ch∆∞a| AUTH[X√°c th·ª±c ng∆∞·ªùi d√πng]
    LOGIN -->|R·ªìi| MAIN[Trang ch√≠nh]
    
    AUTH --> OAUTH{ƒêƒÉng nh·∫≠p Google?}
    OAUTH -->|C√≥| GOOGLE_AUTH[Google OAuth2]
    OAUTH -->|Kh√¥ng| MANUAL_AUTH[ƒêƒÉng nh·∫≠p th·ªß c√¥ng]
    
    GOOGLE_AUTH --> VERIFY_TOKEN[X√°c th·ª±c Google Token]
    MANUAL_AUTH --> CHECK_CREDS[Ki·ªÉm tra th√¥ng tin]
    
    VERIFY_TOKEN --> CREATE_SESSION[T·∫°o JWT Session]
    CHECK_CREDS --> CREATE_SESSION
    
    CREATE_SESSION --> MAIN
    
    MAIN --> ACTIONS{H√†nh ƒë·ªông ng∆∞·ªùi d√πng}
    
    ACTIONS --> POST[T·∫°o b√†i vi·∫øt]
    ACTIONS --> CHAT[Nh·∫Øn tin]
    ACTIONS --> SOCIAL[T∆∞∆°ng t√°c x√£ h·ªôi]
    ACTIONS --> ADMIN[Qu·∫£n tr·ªã]
    
    POST --> AI_CHECK[Ki·ªÉm tra AI]
    AI_CHECK --> AI_APPROVED{ƒê∆∞·ª£c ph√™ duy·ªát?}
    AI_APPROVED -->|C√≥| SAVE_POST[L∆∞u b√†i vi·∫øt]
    AI_APPROVED -->|Kh√¥ng| REJECT_POST[T·ª´ ch·ªëi b√†i vi·∫øt]
    
    CHAT --> REALTIME[WebSocket Real-time]
    SOCIAL --> UPDATE_FEED[C·∫≠p nh·∫≠t Feed]
    ADMIN --> MANAGE_SYSTEM[Qu·∫£n l√Ω h·ªá th·ªëng]
    
    style START fill:#4caf50
    style LOGIN fill:#ff9800
    style AI_CHECK fill:#2196f3
    style REALTIME fill:#9c27b0
```

---

## üîê S∆° ƒê·ªì Quy Tr√¨nh X√°c Th·ª±c

```mermaid
sequenceDiagram
    participant U as User
    participant FE as Frontend
    participant BE as Backend
    participant DB as Database
    participant G as Google OAuth2
    participant JWT as JWT Service
    
    Note over U,JWT: Quy tr√¨nh ƒëƒÉng nh·∫≠p
    
    U->>FE: Nh·∫≠p th√¥ng tin ƒëƒÉng nh·∫≠p
    FE->>FE: Validation form
    
    alt ƒêƒÉng nh·∫≠p Google
        FE->>G: Redirect to Google
        G->>U: Google Login Form
        U->>G: ƒêƒÉng nh·∫≠p Google
        G->>FE: Authorization Code
        FE->>BE: POST /api/v1/auth/google
        BE->>G: Verify Token
        G->>BE: User Info
    else ƒêƒÉng nh·∫≠p th·ªß c√¥ng
        FE->>BE: POST /api/v1/auth/login
        BE->>DB: Ki·ªÉm tra credentials
        DB->>BE: User data
    end
    
    BE->>JWT: T·∫°o JWT Token
    JWT->>BE: JWT Token
    BE->>FE: Token + User Info
    FE->>FE: L∆∞u token localStorage
    FE->>U: Redirect to Dashboard
    
    Note over U,JWT: M·ªçi request sau ƒë√≥ s·∫Ω k√®m JWT token
```

---

## üìù S∆° ƒê·ªì Quy Tr√¨nh T·∫°o B√†i Vi·∫øt v·ªõi AI

```mermaid
flowchart TD
    START([Ng∆∞·ªùi d√πng t·∫°o b√†i vi·∫øt]) --> FORM[ƒêi·ªÅn form b√†i vi·∫øt]
    
    FORM --> UPLOAD{C√≥ upload file?}
    UPLOAD -->|C√≥| CLOUDINARY[Upload l√™n Cloudinary]
    UPLOAD -->|Kh√¥ng| VALIDATE
    
    CLOUDINARY --> GET_URL[Nh·∫≠n URL file]
    GET_URL --> VALIDATE[Validate d·ªØ li·ªáu]
    
    VALIDATE --> SEND_API[G·ª≠i API t·∫°o b√†i vi·∫øt]
    SEND_API --> AUTH_CHECK[Ki·ªÉm tra JWT token]
    AUTH_CHECK --> AI_SERVICE[G·ª≠i ƒë·∫øn AI Service]
    
    AI_SERVICE --> PHOBERT[PhoBERT Model Analysis]
    PHOBERT --> AI_RESULT{K·∫øt qu·∫£ ph√¢n t√≠ch}
    
    AI_RESULT -->|N·ªôi dung ph√π h·ª£p| SAVE_DB[L∆∞u v√†o Database]
    AI_RESULT -->|C√≥ t·ª´ ng·ªØ kh√¥ng ph√π h·ª£p| REJECT[T·ª´ ch·ªëi + Th√¥ng b√°o]
    
    SAVE_DB --> NOTIFY[Th√¥ng b√°o cho followers]
    NOTIFY --> UPDATE_FEED[C·∫≠p nh·∫≠t Feed real-time]
    UPDATE_FEED --> SUCCESS([Ho√†n th√†nh])
    
    REJECT --> ERROR_MSG[Hi·ªÉn th·ªã l·ªói]
    ERROR_MSG --> FORM
    
    style START fill:#4caf50
    style AI_SERVICE fill:#2196f3
    style PHOBERT fill:#ff9800
    style REJECT fill:#f44336
    style SUCCESS fill:#4caf50
```

---

## üí¨ S∆° ƒê·ªì H·ªá Th·ªëng Chat Real-time

```mermaid
sequenceDiagram
    participant U1 as User 1
    participant FE1 as Frontend 1
    participant WS as WebSocket Server
    participant BE as Backend
    participant DB as Database
    participant FE2 as Frontend 2
    participant U2 as User 2
    
    Note over U1,U2: Thi·∫øt l·∫≠p k·∫øt n·ªëi WebSocket
    
    U1->>FE1: M·ªü trang chat
    FE1->>WS: Connect WebSocket
    WS->>BE: X√°c th·ª±c user
    BE->>DB: L·∫•y th√¥ng tin user
    DB->>BE: User info
    BE->>WS: X√°c th·ª±c th√†nh c√¥ng
    WS->>FE1: Connection established
    
    U2->>FE2: M·ªü trang chat
    FE2->>WS: Connect WebSocket
    WS->>FE2: Connection established
    
    Note over U1,U2: G·ª≠i tin nh·∫Øn
    
    U1->>FE1: G√µ tin nh·∫Øn
    FE1->>WS: Send message
    WS->>BE: L∆∞u tin nh·∫Øn
    BE->>DB: INSERT message
    DB->>BE: Confirm saved
    BE->>WS: Message saved
    
    WS->>FE1: Confirm sent
    WS->>FE2: New message
    FE2->>U2: Hi·ªÉn th·ªã tin nh·∫Øn
    
    Note over U1,U2: Typing indicator
    
    U1->>FE1: ƒêang g√µ...
    FE1->>WS: Typing event
    WS->>FE2: User typing
    FE2->>U2: Hi·ªÉn th·ªã "ƒëang g√µ..."
```

---

## üõ°Ô∏è S∆° ƒê·ªì H·ªá Th·ªëng B·∫£o M·∫≠t v√† Ph√¢n Quy·ªÅn

```mermaid
graph TD
    subgraph "Authentication Layer"
        JWT_AUTH[JWT Authentication]
        OAUTH[Google OAuth2]
        SESSION[Session Management]
    end
    
    subgraph "Authorization Layer"
        ROLE_CHECK[Role-based Access Control]
        PERM_CHECK[Permission Validation]
        RESOURCE_AUTH[Resource Authorization]
    end
    
    subgraph "User Roles"
        ADMIN[Administrator]
        USER[Regular User]
        MODERATOR[Moderator]
    end
    
    subgraph "Protected Resources"
        ADMIN_PANEL[Admin Panel]
        USER_DATA[User Data]
        POSTS[Posts Management]
        REPORTS[Report Management]
    end
    
    subgraph "Security Features"
        RATE_LIMIT[Rate Limiting]
        CSRF_PROTECT[CSRF Protection]
        XSS_PREVENT[XSS Prevention]
        SQL_INJECT[SQL Injection Prevention]
    end
    
    JWT_AUTH --> ROLE_CHECK
    OAUTH --> ROLE_CHECK
    SESSION --> ROLE_CHECK
    
    ROLE_CHECK --> ADMIN
    ROLE_CHECK --> USER
    ROLE_CHECK --> MODERATOR
    
    ADMIN --> ADMIN_PANEL
    ADMIN --> REPORTS
    USER --> USER_DATA
    USER --> POSTS
    MODERATOR --> POSTS
    MODERATOR --> REPORTS
    
    ROLE_CHECK --> RATE_LIMIT
    PERM_CHECK --> CSRF_PROTECT
    RESOURCE_AUTH --> XSS_PREVENT
    
    style JWT_AUTH fill:#4caf50
    style OAUTH fill:#2196f3
    style ADMIN fill:#ff5722
    style USER fill:#009688
    style RATE_LIMIT fill:#ff9800
```

---

## ü§ñ S∆° ƒê·ªì AI Service v√† Machine Learning Pipeline

```mermaid
flowchart LR
    subgraph "Input Processing"
        TEXT_INPUT[Text Input]
        PREPROCESS[Text Preprocessing]
        TOKENIZE[Tokenization]
    end
    
    subgraph "AI Model"
        PHOBERT[PhoBERT Model]
        CLASSIFICATION[Classification Layer]
        PREDICTION[Prediction Output]
    end
    
    subgraph "Decision Engine"
        THRESHOLD[Threshold Check]
        DECISION{Content Appropriate?}
        CONFIDENCE[Confidence Score]
    end
    
    subgraph "Output Processing"
        APPROVE[Approve Content]
        REJECT[Reject Content]
        LOG[Log Results]
        FEEDBACK[Feedback Loop]
    end
    
    TEXT_INPUT --> PREPROCESS
    PREPROCESS --> TOKENIZE
    TOKENIZE --> PHOBERT
    
    PHOBERT --> CLASSIFICATION
    CLASSIFICATION --> PREDICTION
    PREDICTION --> THRESHOLD
    
    THRESHOLD --> CONFIDENCE
    CONFIDENCE --> DECISION
    
    DECISION -->|Yes| APPROVE
    DECISION -->|No| REJECT
    
    APPROVE --> LOG
    REJECT --> LOG
    LOG --> FEEDBACK
    FEEDBACK --> PHOBERT
    
    style PHOBERT fill:#ff9800
    style DECISION fill:#2196f3
    style APPROVE fill:#4caf50
    style REJECT fill:#f44336
```

---

## üìä S∆° ƒê·ªì Database Schema

```mermaid
erDiagram
    USERS {
        bigint id PK
        varchar username UK
        varchar email UK
        varchar password_hash
        varchar first_name
        varchar last_name
        boolean enabled
        timestamp created_at
        timestamp updated_at
    }
    
    USER_DATA {
        bigint id PK
        bigint user_id FK
        text bio
        varchar avatar_url
        varchar location
        date date_of_birth
        varchar phone
    }
    
    POSTS {
        bigint id PK
        bigint user_id FK
        text content
        varchar media_url
        varchar location
        timestamp created_at
        timestamp updated_at
        boolean is_deleted
    }
    
    COMMENTS {
        bigint id PK
        bigint post_id FK
        bigint user_id FK
        text content
        timestamp created_at
        boolean is_deleted
    }
    
    FRIENDSHIPS {
        bigint id PK
        bigint user_id FK
        bigint friend_id FK
        varchar status
        timestamp created_at
    }
    
    MESSAGES {
        bigint id PK
        bigint sender_id FK
        bigint receiver_id FK
        text content
        timestamp sent_at
        boolean is_read
    }
    
    POST_LIKES {
        bigint id PK
        bigint post_id FK
        bigint user_id FK
        timestamp created_at
    }
    
    REPORTS {
        bigint id PK
        bigint reporter_id FK
        bigint reported_user_id FK
        bigint post_id FK
        varchar reason
        varchar status
        timestamp created_at
    }
    
    USERS ||--o{ USER_DATA : has
    USERS ||--o{ POSTS : creates
    USERS ||--o{ COMMENTS : writes
    USERS ||--o{ FRIENDSHIPS : has
    USERS ||--o{ MESSAGES : sends
    USERS ||--o{ POST_LIKES : likes
    USERS ||--o{ REPORTS : reports
    
    POSTS ||--o{ COMMENTS : has
    POSTS ||--o{ POST_LIKES : receives
    POSTS ||--o{ REPORTS : reported
```

---

## üöÄ S∆° ƒê·ªì Deployment v√† DevOps

```mermaid
graph TB
    subgraph "Development"
        DEV_ENV[Local Development]
        GIT[Git Repository]
        IDE[VS Code IDE]
    end
    
    subgraph "CI/CD Pipeline"
        GITHUB[GitHub Actions]
        BUILD[Build Process]
        TEST[Automated Testing]
        DEPLOY[Deployment]
    end
    
    subgraph "Production Environment - Render"
        FE_RENDER[Frontend Service]
        BE_RENDER[Backend Service]
        AI_RENDER[AI Service]
        DB_RENDER[PostgreSQL Database]
    end
    
    subgraph "External Services"
        CLOUDINARY_PROD[Cloudinary]
        GOOGLE_OAUTH[Google OAuth2]
        EMAIL_SERVICE[Email Service]
    end
    
    subgraph "Monitoring"
        LOGS[Application Logs]
        METRICS[Performance Metrics]
        ALERTS[Error Alerts]
    end
    
    DEV_ENV --> GIT
    GIT --> GITHUB
    GITHUB --> BUILD
    BUILD --> TEST
    TEST --> DEPLOY
    
    DEPLOY --> FE_RENDER
    DEPLOY --> BE_RENDER
    DEPLOY --> AI_RENDER
    
    BE_RENDER --> DB_RENDER
    BE_RENDER --> CLOUDINARY_PROD
    BE_RENDER --> GOOGLE_OAUTH
    BE_RENDER --> EMAIL_SERVICE
    
    FE_RENDER --> LOGS
    BE_RENDER --> LOGS
    AI_RENDER --> LOGS
    
    LOGS --> METRICS
    METRICS --> ALERTS
    
    style GITHUB fill:#333
    style FE_RENDER fill:#61dafb
    style BE_RENDER fill:#6db33f
    style AI_RENDER fill:#ff6f00
    style DB_RENDER fill:#336791
```

---

## üì± S∆° ƒê·ªì User Experience Flow

```mermaid
journey
    title User Journey - WingIt Social Platform
    
    section ƒêƒÉng k√Ω/ƒêƒÉng nh·∫≠p
        Truy c·∫≠p trang web: 5: User
        Ch·ªçn ƒëƒÉng k√Ω: 4: User
        ƒêi·ªÅn th√¥ng tin: 3: User
        X√°c th·ª±c email: 4: User
        ƒêƒÉng nh·∫≠p th√†nh c√¥ng: 5: User
    
    section Thi·∫øt l·∫≠p Profile
        Upload avatar: 4: User
        ƒêi·ªÅn th√¥ng tin c√° nh√¢n: 4: User
        Thi·∫øt l·∫≠p privacy: 3: User
        Ho√†n th√†nh profile: 5: User
    
    section S·ª≠ d·ª•ng h·ªá th·ªëng
        Xem feed: 5: User
        T·∫°o b√†i vi·∫øt: 5: User
        T∆∞∆°ng t√°c b√†i vi·∫øt: 5: User
        Chat v·ªõi b·∫°n b√®: 5: User
        Nh·∫≠n th√¥ng b√°o: 4: User
    
    section Qu·∫£n l√Ω t√†i kho·∫£n
        Ch·ªânh s·ª≠a profile: 4: User
        Thay ƒë·ªïi c√†i ƒë·∫∑t: 3: User
        Qu·∫£n l√Ω b·∫°n b√®: 4: User
        B√°o c√°o vi ph·∫°m: 3: User
```

---

## üîß C·∫•u H√¨nh K·ªπ Thu·∫≠t Chi Ti·∫øt

### Frontend (Next.js)
- **Framework**: Next.js 15.3.2 v·ªõi React 18
- **Language**: TypeScript
- **Styling**: Tailwind CSS, Styled Components
- **State Management**: Redux Toolkit
- **UI Components**: NextUI, Ant Design
- **Authentication**: JWT v·ªõi localStorage
- **Real-time**: WebSocket client
- **Build Tool**: Next.js built-in

### Backend (Spring Boot)
- **Framework**: Spring Boot 3.4.5
- **Language**: Java 17
- **Database**: PostgreSQL (Production), MySQL (Development)
- **Authentication**: JWT + Spring Security
- **Real-time**: WebSocket with STOMP
- **File Upload**: Cloudinary integration
- **API Documentation**: Swagger/OpenAPI
- **Build Tool**: Maven

### AI Service (Flask)
- **Framework**: Flask 2.3.2
- **Language**: Python 3.9+
- **ML Model**: PhoBERT (Vietnamese BERT)
- **Libraries**: Transformers, PyTorch
- **API**: RESTful endpoints
- **Deployment**: Docker container

### Database
- **Production**: PostgreSQL on Render
- **Development**: MySQL local
- **ORM**: JPA/Hibernate
- **Connection Pooling**: HikariCP
- **Migrations**: Flyway

---

## üìà S∆° ƒê·ªì Hi·ªáu Su·∫•t v√† T·ªëi ∆Øu H√≥a

```mermaid
graph LR
    subgraph "Frontend Optimization"
        LAZY[Lazy Loading]
        CACHE[Browser Caching]
        COMPRESS[Asset Compression]
        CDN[CDN Delivery]
    end
    
    subgraph "Backend Optimization"
        DB_POOL[Connection Pooling]
        REDIS[Redis Caching]
        ASYNC[Async Processing]
        PAGINATION[Pagination]
    end
    
    subgraph "Database Optimization"
        INDEXING[Database Indexing]
        QUERY_OPT[Query Optimization]
        PARTITIONING[Table Partitioning]
    end
    
    subgraph "AI Optimization"
        MODEL_CACHE[Model Caching]
        BATCH_PROCESS[Batch Processing]
        GPU_ACCEL[GPU Acceleration]
    end
    
    LAZY --> CDN
    CACHE --> CDN
    COMPRESS --> CDN
    
    DB_POOL --> REDIS
    ASYNC --> REDIS
    PAGINATION --> REDIS
    
    INDEXING --> QUERY_OPT
    QUERY_OPT --> PARTITIONING
    
    MODEL_CACHE --> BATCH_PROCESS
    BATCH_PROCESS --> GPU_ACCEL
    
    style CDN fill:#4caf50
    style REDIS fill:#dc382d
    style QUERY_OPT fill:#336791
    style GPU_ACCEL fill:#ff9800
```

---

## üéØ T·ªïng K·∫øt

H·ªá th·ªëng WingIt ƒë∆∞·ª£c thi·∫øt k·∫ø v·ªõi ki·∫øn tr√∫c microservices hi·ªán ƒë·∫°i, ƒë·∫£m b·∫£o:

### ‚úÖ ∆Øu ƒëi·ªÉm
- **Scalability**: C√≥ th·ªÉ m·ªü r·ªông t·ª´ng service ƒë·ªôc l·∫≠p
- **Reliability**: Fault tolerance v√† error handling
- **Security**: Nhi·ªÅu l·ªõp b·∫£o m·∫≠t v√† x√°c th·ª±c
- **Performance**: T·ªëi ∆∞u h√≥a t·ª´ frontend ƒë·∫øn database
- **Maintainability**: Code s·∫°ch v√† ki·∫øn tr√∫c r√µ r√†ng
- **AI Integration**: Ki·ªÉm duy·ªát n·ªôi dung t·ª± ƒë·ªông

### üöÄ C√¥ng ngh·ªá s·ª≠ d·ª•ng
- **Frontend**: Next.js, React, TypeScript, Tailwind CSS
- **Backend**: Spring Boot, Java, PostgreSQL
- **AI**: Python, Flask, PhoBERT, Transformers
- **DevOps**: Docker, Render, GitHub Actions
- **External**: Cloudinary, Google OAuth2

### üìä Kh·∫£ nƒÉng m·ªü r·ªông
- H·ªó tr·ª£ real-time communication
- AI-powered content moderation
- Microservices architecture
- Cloud-native deployment
- Mobile-responsive design
